#include "GameCore.h"

GameCore::GameCore() {}
GameCore::~GameCore() {}

//////////////////////////////////////////////////////////////////////////////////////////////////
// ↓　終了処理
//////////////////////////////////////////////////////////////////////////////////////////////////

void GameCore::Finalize() {
	sceneManger_->Finalize();
	AoiFramework::Finalize();
}


//////////////////////////////////////////////////////////////////////////////////////////////////
// ↓　初期化処理
//////////////////////////////////////////////////////////////////////////////////////////////////
void GameCore::Init() {
	AoiFramework::Init();

	sceneManger_ = std::make_unique<SceneManager>();
	sceneManger_->Init();

	sceneManger_->SetChange(SceneType::TITLE);
}

//////////////////////////////////////////////////////////////////////////////////////////////////
// ↓　更新処理
//////////////////////////////////////////////////////////////////////////////////////////////////

void GameCore::Update() {
	AoiFramework::Update();

	SceneChange();

	sceneManger_->Update();
#ifdef _DEBUG
	Debug_Gui();
#endif
}

//////////////////////////////////////////////////////////////////////////////////////////////////
// ↓　描画処理
//////////////////////////////////////////////////////////////////////////////////////////////////

void GameCore::Draw() {
	sceneManger_->Draw();

	sceneManger_->PostFrame();
}

void GameCore::SceneChange() {
#ifdef _DEBUG
	if (sceneManger_->GetIsChange()) {
		sceneManger_->SetChange(sceneType_);
		sceneManger_->SetIsChange(false);
	}
#endif
}

#ifdef _DEBUG
#include "Engine/Manager/ImGuiManager.h"
void GameCore::Debug_Gui() {
	ImGui::Begin("Scene");
	sceneManger_->Show_Gui();
	int type = (int)sceneType_;
	ImGui::Combo("attackType##type", &type, "TITLE\0TUTORIAL\0GAME\0GAMECLEAR\0GAMEOVER\0TEST\0");
	sceneType_ = (SceneType)type;
	if (ImGui::Button("Change")) {
		sceneManger_->SetIsChange(true);
	}
	ImGui::End();
}
#endif