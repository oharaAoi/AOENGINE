#include "LaserRifle.h"
#include "Engine/System/Manager/ParticleManager.h"

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 編集
///////////////////////////////////////////////////////////////////////////////////////////////

void LaserRifle::Debug_Gui() {
	BaseWeapon::Debug_Gui();
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 終了
///////////////////////////////////////////////////////////////////////////////////////////////

void LaserRifle::Finalize() {
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 初期化
///////////////////////////////////////////////////////////////////////////////////////////////

void LaserRifle::Init() {
	// 初期化と保存項目の取得
	SetName("LaserRifle");
	BaseWeapon::Init();
	attackParam_.SetName("MachineGunAttackParam");
	attackParam_.Load();

	object_->SetObject("gun.obj");

	EditorWindows::AddObjectWindow(this, GetName());
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 攻撃
///////////////////////////////////////////////////////////////////////////////////////////////

bool LaserRifle::Attack(const AttackContext& cxt) {
	if (!isCanAttack_) { return false; }

	Vector3 worldPos = object_->GetPosition();
	PlayerBullet* bullet = pBulletManager_->AddBullet<PlayerBullet>(worldPos, cxt.direction * attackParam_.bulletSpeed);
	bullet->SetTakeDamage(attackParam_.takeDamage);

	AttackAfter();
	return true;
}
