#include "BossActionIdle.h"
#include "Game/Actor/Boss/Boss.h"
#include "Engine/Lib/GameTimer.h"
#include "Game/Actor/Boss/Action/BossActionApproach.h"
#include "Game/Actor/Boss/Action/BossActionAllRangeMissile.h"
#include "Engine/Lib/Math/MyRandom.h"

#ifdef _DEBUG
void BossActionIdle::Debug_Gui() {
}
#endif // _DEBUG

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 設定時のみ行う処理
///////////////////////////////////////////////////////////////////////////////////////////////

void BossActionIdle::Build() {
	SetName("ActionIdle");
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 初期化処理
///////////////////////////////////////////////////////////////////////////////////////////////

void BossActionIdle::OnStart() {
	actionTimer_ = 0;

	playerToRotate_ = Quaternion::LookAt(pOwner_->GetPosition(), pOwner_->GetPlayerPosition());
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 更新処理
///////////////////////////////////////////////////////////////////////////////////////////////

void BossActionIdle::OnUpdate() {
	actionTimer_ += GameTimer::DeltaTime();

	playerToRotate_ = Quaternion::LookAt(pOwner_->GetPosition(), pOwner_->GetPlayerPosition());
	pOwner_->GetTransform()->rotation_ = Quaternion::Slerp(pOwner_->GetTransform()->rotation_, playerToRotate_, 0.05f);

}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 終了処理
///////////////////////////////////////////////////////////////////////////////////////////////

void BossActionIdle::OnEnd() {
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 次のアクションのチェック
///////////////////////////////////////////////////////////////////////////////////////////////

void BossActionIdle::CheckNextAction() {
	if (actionTimer_ > 4.0f) {
		int rand = RandomInt(0, 1);
		if (rand == 0) {
			NextAction<BossActionApproach>();
		} else {
			NextAction<BossActionAllRangeMissile>();
		}
		
	}
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 入力処理
///////////////////////////////////////////////////////////////////////////////////////////////

bool BossActionIdle::IsInput() {
	return false;
}
