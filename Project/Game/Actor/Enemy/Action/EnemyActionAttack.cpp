#include "EnemyActionAttack.h"
#include "Game/Actor/Enemy/BaseEnemy.h"

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 実行処理
///////////////////////////////////////////////////////////////////////////////////////////////

BehaviorStatus EnemyActionAttack::Execute() {
    return Action();
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 重みを計算
///////////////////////////////////////////////////////////////////////////////////////////////

float EnemyActionAttack::EvaluateWeight() {
    return 0.0f;
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 編集処理
///////////////////////////////////////////////////////////////////////////////////////////////

void EnemyActionAttack::Debug_Gui() {
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 終了確認
///////////////////////////////////////////////////////////////////////////////////////////////

bool EnemyActionAttack::IsFinish() {
    if (pTarget_->GetWeapon()->GetIsReload()) {
        return true;
    }
    return false;
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 実行確認
///////////////////////////////////////////////////////////////////////////////////////////////

bool EnemyActionAttack::CanExecute() {
    if (pTarget_->GetWeapon()->GetIsReload()) {
        return false;
    }

    return true;
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 初期化処理
///////////////////////////////////////////////////////////////////////////////////////////////

void EnemyActionAttack::Init() {
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 更新処理
///////////////////////////////////////////////////////////////////////////////////////////////

void EnemyActionAttack::Update() {
    pTarget_->TargetLook();

    Math::Vector3 dire = pTarget_->GetTransform()->srt_.rotate.MakeForward();
    pTarget_->GetWeapon()->Attack(AttackContext(dire, pTarget_->GetTargetTransform()->GetPos()));
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 終了処理
///////////////////////////////////////////////////////////////////////////////////////////////

void EnemyActionAttack::End() {
}
