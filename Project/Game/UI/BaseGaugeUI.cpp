#include "BaseGaugeUI.h"
#include "Engine.h"

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 初期化処理
///////////////////////////////////////////////////////////////////////////////////////////////

void BaseGaugeUI::Init(const std::string& bgTexture, const std::string& frontTexture) {
	bg_ = Engine::CreateSprite(bgTexture);
	front_ = Engine::CreateSprite(frontTexture);

	fillAmount_ = 1.0f;
	centerPos_ = Vector2(kWindowWidth_ * 0.5f, kWindowHeight_ * 0.5f);

	bg_->SetTranslate(centerPos_);
	front_->SetTranslate(centerPos_);

	bg_->SetScale(scale_);
	front_->SetScale(scale_);
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 更新処理
///////////////////////////////////////////////////////////////////////////////////////////////

void BaseGaugeUI::Update() {
	front_->FillAmount(fillAmount_, fillMoveType_);
	
	bg_->SetTranslate(centerPos_);
	front_->SetTranslate(centerPos_);

	bg_->SetScale(scale_);
	front_->SetScale(scale_);

	bg_->Update();
	front_->Update();
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 描画処理
///////////////////////////////////////////////////////////////////////////////////////////////
void BaseGaugeUI::Draw() const {
	Pipeline* pso = Engine::GetLastUsedPipeline();
	bg_->Draw(pso);
	front_->Draw(pso);
}

///////////////////////////////////////////////////////////////////////////////////////////////
// ↓ 編集処理
///////////////////////////////////////////////////////////////////////////////////////////////

void BaseGaugeUI::Debug_Gui() {
	ImGui::DragFloat2("Scale", &scale_.x, 0.1f);
	ImGui::DragFloat2("CenterPos", &centerPos_.x, 0.1f);
	ImGui::DragFloat("FillAmount", &fillAmount_, 0.01f);

	bg_->SetScale(scale_);
	front_->SetScale(scale_);
}